## Key points next q 71

### Autoscaling

- Redshift (data warehousing) cluster is **single AZ**
- Migrate the MySQL database server into a Multi-AZ Amazon RDS for MySQL.
- Enable API caching on API Gateway to reduce the number of Lambda function invocations.
- Use ElasticCache Redis when HA is a must, Memcached **DOES NOT** provide HA
- Use ElasticBeanstalk will give you least amount of efforts to enable autoscaling while keeping no service disruption

### Business Continuity

- Spot instance can be interrupted. Reserved Instance provides massive discount and needs at least **1 year** rental term.
- Use DLQ (dead letter queue) for failed transactions reprocess.
- If `RPO` of 1 hour is required, it basically requires backup of data store to be hourly-based.
- CloudFront - Create two cache behaviors for static and dynamic content. Remove the **User-Agent** HTTP header from the whitelist headers section on both of the cache behaviors. Remove the **session cookie** from the whitelist cookies section and the **Authorization HTTP header** from the whitelist headers section for cache behavior configured for static content.
- **EBS is 10 times more expensive than s3**
- Workflow is best to be dealt with AWS SWF

### Cost Management

- Use lambda@edge when you can - it is a feature of Amazon CloudFront that lets you run code **closer to users of your application, which improves performance and reduces latency**. With Lambda@Edge, you don't have to provision or manage infrastructure in multiple locations around the world. You pay only for the compute time you consume - there is no charge when your code is not running.

With Lambda@Edge, you can enrich your web applications by making them globally distributed and improving their performance â€” all with zero server administration. Lambda@Edge runs your code in response to events generated by the Amazon CloudFront content delivery network (CDN).

- When s3 needs to be accessed by a group of orgs. S3 owner can impose a s3 policy to enable other orgs to have access to it subject to each of them having own aws account. Enable **Requester Pays on the bucket**. Have the orgs use their own aws credentials when accessing the bucket.

### Migration

- Cert produced by AWS Cert Manager **CANNOT BE** cross-region
- Snowmobile is recommended for transferring data more than **10PB**
- AWS Application Discovery Service helps enterprise customers plan migration projects by gathering information about their on-premises data centers. It has 2 flavours - agent and agentless. When processes information is required, must use agent.
- AWS Database Migration Service does not work with ElasticCache

### Data Store

- Max EBS IOPS is **64000*.
- S3 IA is suitable for data that is accessed infrequently but still needs an **immediate access**.
- GP2 has **3 IOPS** per GB
- EFS has **higher latency** than EBS provisioned IOPS
- DynamoDB **DOES NOT** support CW events
- cross-region replication has 2 copies and hence **double the cost**.
- ElasticCache requires implementation code in application

### Deployment and operation management

- API Gateway has a payload limit of 10Mb Size Limitation
- Use AWS SAM and built-in AWS **CodeDeploy** to deploy the new Lambda version, gradually shift traffic to the new version, and use pre-traffic and post-traffic test functions to verify code. Rollback if Amazon CloudWatch alarms are triggered.
- `--regions` is NOT a valid param in cfn cli.
- **`Aurora` cluster is multi-az by default**
- lambda can support up to 1000 concurrent calls per second. But limit can be increased.

### Networking

- Site-to-Site VPN Conn **DOES NOT** provide high bandwidth. Each AWS Site-to-Site VPN connection has two tunnels and each tunnel supports a maximum throughput of up to **1.25 Gbp**.
- Software VPN with clustering has **ONLY** one conn and hence isn't HA
- Use **public virtual interface** on a Direct Connect to transfer huge amount of data over the weekend
- When being asked about data movement, choose `Public virtual interface` on a Direct Connect connection.
- max limit **125** peering conns per vpc
- VPN requires internet and does not unfold source ip
- VPC Peering does not block anything
- Public VIF - AWS Direct Connect public VIFs allow you to connect to the `AWS public endpoints with public IP addresses (such as Amazon S3 and Amazon DynamoDB) that are advertised to AWS` over Border Gateway Protocol (BGP).

### Security

- Use **AWS Org** and add accounts from departments to an O(rg) (U)nit when seeing **autonomy/service isolations**.
- Cloudtrail to SNS **DOES NOT** have filtering
- **Amazon S3 event notifications typically deliver events in seconds but can sometimes take a minute or longer. On very rare occasions, events might be lost**
- AWS Trusted adviser is NOT event driven, i.e., it must be scheduled. This means running it on some frequency, the quickest refresh is every 5 minutes. It helps with resources provisioning with best practices.
- Use AWS System Manager on all instances to manage patching
- S3 generated keys cannot be managed
- Use tag-based IAM policy to implement granular access control over certain resources. Read Tagging in [cost-management](./cost-management)

